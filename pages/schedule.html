<div class="table-container">
    <table id="mainScheduleTable" class="schedule-table">
        <thead>
            <tr id="tableHeaderRow">
                <th>Godzina</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Połączony pasek informacji i legendy -->
    <div class="schedule-footer-bar">
        <div id="dayProgressContainer"></div>
        <div class="compact-legend">
            <div class="legend-item" data-type="massage"><span class="legend-dot massage-color"></span>Masaż</div>
            <div class="legend-item" data-type="pnf"><span class="legend-dot pnf-color"></span>PNF</div>
            <div class="legend-item" data-type="every-other-day"><span
                    class="legend-dot every-other-day-color"></span>Co 2 Dni</div>
            <div class="legend-item" data-type="hydrotherapy"><span
                    class="legend-dot hydrotherapy-color"></span>Hydroterapia</div>
            <div class="legend-item" data-type="break"><span class="legend-dot break-color"></span>Przerwa</div>
        </div>
        <div id="patientCount" class="patient-count-badge"></div>
    </div>
</div>

<div id="contextMenu" class="context-menu">
    <ul>
        <li id="contextPatientInfo" class="info">
            <i class="fas fa-user-circle"></i><span>Informacje o pacjencie</span>
        </li>
        <li id="contextSplitCell"><i class="fas fa-columns"></i><span>Podziel komórkę</span></li>
        <li id="contextMergeCells"><i class="fas fa-compress-arrows-alt"></i><span>Scal komórki</span></li>
        <li id="contextAddBreak"><i class="fas fa-coffee"></i><span>Dodaj przerwę</span></li>
        <li id="contextHydrotherapy">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-waves-ladder-icon lucide-waves-ladder">
                <path d="M19 5a2 2 0 0 0-2 2v11" />
                <path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1" />
                <path d="M7 13h10" />
                <path d="M7 9h10" />
                <path d="M9 5a2 2 0 0 0-2 2v11" />
            </svg>
            <span>Hydroterapia</span>
        </li>
        <li class="has-submenu">
            <i class="fas fa-cogs"></i><span>Rodzaj zabiegu</span><i class="fas fa-chevron-right submenu-arrow"></i>
            <ul class="context-submenu">
                <li id="contextMassage"><i class="fas fa-hand-paper"></i><span>Masaż</span></li>
                <li id="contextPnf"><i class="fas fa-brain"></i><span>PNF</span></li>
                <li id="contextEveryOtherDay"><i class="fas fa-calendar-alt"></i><span>Co drugi dzień</span></li>
                <li id="contextClearFormatting"><i class="fas fa-eraser"></i><span>Wyczyść</span></li>
            </ul>
        </li>
        <li id="contextShowHistory"><i class="fas fa-history"></i><span>Pokaż historię</span></li>
        <li id="contextClear" class="danger"><i class="fas fa-trash-alt"></i><span>Wyczyść komórkę</span></li>
        <li id="contextRemoveBreak" class="danger" style="display: none">
            <i class="fas fa-backspace"></i><span>Usuń przerwę</span>
        </li>
    </ul>
</div>

<!-- Modal Historii Zmian -->
<div id="historyModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <h2 class="modal-title">Historia zmian komórki</h2>
        <div id="historyModalBody" class="modal-body">
            <!-- History entries will be injected here -->
        </div>
        <div class="modal-actions">
            <button id="closeHistoryModal" class="action-btn outline">Zamknij</button>
        </div>
    </div>
</div>

<!-- Modal informacji o pacjencie -->
<div id="patientInfoModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <h2 class="modal-title">Informacje o pacjencie</h2>
        <div class="modal-body">
            <div class="form-group patient-name-row">
                <label for="patientName">Imię i nazwisko:</label>
                <input type="text" id="patientName" readonly />
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="treatmentStartDate">Data rozpoczęcia:</label>
                    <input type="date" id="treatmentStartDate" />
                </div>
                <div class="form-group">
                    <label for="treatmentExtensionDays">Przedłużenie (dni):</label>
                    <input type="number" id="treatmentExtensionDays" min="0" value="0" />
                </div>
            </div>
            <div class="form-group">
                <label for="treatmentEndDate">Data zakończenia:</label>
                <input type="text" id="treatmentEndDate" readonly class="bold-large-font" />
            </div>
            <div class="form-group">
                <label for="additionalInfo">Informacje dodatkowe:</label>
                <textarea id="additionalInfo" rows="3"></textarea>
            </div>
        </div>
        <div class="modal-actions">
            <button id="savePatientInfoModal" class="action-btn primary">Zapisz</button>
            <button id="closePatientInfoModal" class="action-btn outline">Anuluj</button>
        </div>
    </div>
</div>

<!-- Modal do potwierdzenia wprowadzenia ciągu cyfr -->
<div id="numericConfirmationModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <h2 class="modal-title">Potwierdź wprowadzenie danych</h2>
        <p id="numericConfirmationModalText">Czy na pewno chcesz wprowadzić ten ciąg cyfr?</p>
        <div class="modal-actions">
            <button id="confirmNumericBtn" class="action-btn primary">Tak, wprowadź</button>
            <button id="cancelNumericBtn" class="action-btn outline">Anuluj</button>
        </div>
    </div>
</div>

<div id="duplicateModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <p id="duplicateModalText"></p>
        <div class="modal-buttons modal-actions">
            <div class="modal-buttons modal-actions">
                <button id="moveEntryBtn" class="action-btn primary">Przenieś</button>
                <button id="addAnywayBtn" class="action-btn secondary">Dodaj mimo to</button>
                <button id="cancelBtn" class="action-btn outline">Anuluj</button>
            </div>
        </div>
    </div>
</div>